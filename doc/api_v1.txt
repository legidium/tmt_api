API v1 от 09.06.2016

1 Описание

    Поддерживаются следующие методы запросов к API: GET, POST.
    Входные парaметры POST запросов должны передаваться в формате JSON  (Content-Type: application/json).
    Ответ от API всегда приходит в формате JSON.
    В каждом ответе всегда передается статус заверешения операции.
    Для доступа к сервисам, требующих авторизации, необходимо получить ключ доступа, см «Авторизация».


2 Структура вызовов API

    Для доступа к API предполагается использовать специальный поддомен - http://api.<HOST_NAME>

    ::= - определение
    {}  - обязательный элемент
    []  - необязательный элемент
    |   - ИЛИ

    SERVICE ::= http://api.{HOST_NAME}/{API_VERSION}/{RESOURCE_NAME}[?PARAMS]

    API_VERSION   - версия API
    RESOURCE_NAME - путь к ресурсу

    PARAMS ::=
    PARAM1_NAME=PARAM1_VALUE[&PARAM2_NAME=PARAM2_VALUE[...]]


3 Авторизация

3.1 Описание

    Для доступа к сервисам, требующих авторизации, используется ключ доступа `access_token`.
    Чтобы получить `access_token` необходимо отправить запрос к API с данными о пользователе (логин и пароль).
    Если запрос обработан без ошибок, система вернет ключ доступа `access_token`, время действия ключа `expires_in`
    и код для обновления ключа `refresh_token`. Далее, все последующие запросы к защищенным ресурсам должны включать
    значение поля `access_token`, cм. "Использование ключа доступа".

    Во время получения ключа доступа, система может вернуть ошибку с полем 'license_url'.
    Это означает, что для успешной авторизации, пользователю необходимо принять лизензию, см. "Лицензия".
    После принятия пользователем лицензии, нужно повторно запросить ключа доступа.

    По истечению срока действия, ключ доступа становится недействительным. Все запросы с использованием этого ключа
    будут возвращать ошибку с сообщением 'Token expired'. Чтобы продолжить пользоваться сервисами API, требующих авторизации,
    необходимо обновить ключ доступа при помощи одноразового кода 'refresh_token', см. "Обновление ключа доступа"

3.2 Получение ключа доступа

    Запрос:

    Тип                 URL
    --------------------------------------------------------------------------------------------------------------------------------
    POST                /v1/auth/authorize
    --------------------------------------------------------------------------------------------------------------------------------

    Параметры в теле запроса (JSON):

    Имя                 Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    login               string                  Логин пользователя
    pass                string                  Пароль
    --------------------------------------------------------------------------------------------------------------------------------
    Пример запроса:
    {
        "login": "user",
        "pass": "12345"
    }

    Примеры ответов:

    Пример успешного ответа:
    {
      "success": 1,
      "access_token": "4FvPOexENLTHl1ZWFSN1p1iy3QSZ0M78",
      "expires_in": 3600,
      "refresh_token": "U8OHI9oDldF55wzjyoQQOJUVa5niI5Va",
      "role": 1
    }

    Где:
    success       - статус ответа
    access_token  - ключ доступа
    expires_in    - срок дейстсвия клюа доступа в секундах
    refresh_token - одноразовый код для обновления ключа доступа с истекшим сроком действия
    role          - код роли пользователя

                    Где:

                    0 - Полевой сотрудник
                    1 - Полевой начальник
                    2 - Менеджер


    Пример ответа с ошибкой (требованием принять лицензию):
    {
      "success": 0,
      "error_code": 202,
      "error_message": "License confirmation required",
      "error_log": [],
      "license_url": "/license.pdf"
    }

    Где:
    success       - статус ответа
    error_code    - код ошибки
    error_message - краткое описание ошибки
    error_log     - список полей с ошибками
    license_url   - ссылка на документ лицензии см. "Лицензия"

    Пример ответа с ошибкой (неправильный пароль):
    {
      "success": 0,
      "error_code": 201,
      "error_message": "Bad credentials",
      "error_log": {
        "pass": "Invalid password"
      }
    }

    Где:
    success       - статус ответа
    error_code    - код ошибки
    error_message - краткое описание ошибки
    error_log     - список полей с ошибками

3.3 Использование ключа доступа

    Ключ доступа к защищенным ресурсам должен передаваться в HTTP заголовке, в поле Authorization.
    При отсутсвии или неправильном значении этого поля, систем будет возвращать ответ с ошибкой доступа.

    Пример передачи ключа доступа в заголовке HTTP:

    Authorization: Bearer 4FvPOexENLTHl1ZWFSN1p1iy3QSZ0M78

3.4 Обновление ключа доступа

    В целях безопасности время действия ключа доступа `access_token` ограничено.
    После успешного запроса на авторизацию, ответ содержит поле `expires_in` со значением срока действия ключа доступа.
    Обычно этот срок составлет от нескольких минут до 1 часа. По истечении этого времени, ключ доступа становится недействительным.
    Все запросы с этим ключом будут возвращать ошибку.

    Пример ответа с ошибокой:
    {
      "success": 0,
      "error_code": 5,
      "error_message": "Token expired",
      "error_log": []
    }

    Чтобы избежать повторной авторизации, применется метод обновления ключа доступа при помощи одноразового кода.
    В ответе на запрос авторизации помимо самого ключа и времени действия, приходит код для его обновления `refresh_token`.
    Этот код нужно использовать в запросе на обновление ключа доступа. Если запрос на обновление ключа прошел без ошибок,
    система веренет данные о новом ключе доступа. Формат ответа аналогичен ответу на запрос для получения
    ключа доступа см. "Получение ключа доступа".

    Запрос:

    Тип                 URL
    --------------------------------------------------------------------------------------------------------------------------------
    POST                /v1/auth/refresh
    --------------------------------------------------------------------------------------------------------------------------------

    Параметры в теле запроса (JSON):

    Имя                 Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    refresh_token       string                  Код для обновления ключа доступа
    --------------------------------------------------------------------------------------------------------------------------------

    Пример запроса:
    {
      "refresh_token": "U8OHI9oDldF55wzjyoQQOJUVa5niI5Va"
    }

    Пример успешного ответа:
    {
      "success": 1,
      "access_token": "LqcDp1yu-Ij4FVDqjfz14GNgM0f1knY3",
      "expires_in": 3600,
      "refresh_token": "gTu6t0jV4BpkB2cZ6N8OcSPtJNzNd5_a"
    }

    Пример ответа с ошибкой:
    {
      "success": 0,
      "error_code": 4,
      "error_message": "Bad token",
      "error_log": []
    }

3.5 Сброс пароля пользователя

    Если пользователь забыл свой пароль, API предоставляет возможность сбросить старый пароль и автоматически
    сгенерировать новый. Для этого в запросе на сброс пароля нужно указать логин или email пользователья.
    Если пользователь с такими данными существует, система отправит новый пароль на его эл. почту.

    Запрос:

    Тип                 URL
    --------------------------------------------------------------------------------------------------------------------------------
    POST                /v1/auth/password
    --------------------------------------------------------------------------------------------------------------------------------

    Параметры в теле запроса (JSON):

    Имя                 Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    login               string                  Логин или Email пользователя
    --------------------------------------------------------------------------------------------------------------------------------

    Пример запроса:
    {
      "login": "user@domain.ru"
    }

    Пример успешного ответа:
    {
      "success": 1
    }

    Пример ответа с ошибкой:
    {
      "success": 0,
      "error_code": 201,
      "error_message": "Bad credentials",
      "error_log": {
        "login": "Unknown login"
      }
    }

3.6 Лицензия

    Для работы с приложением пользователю может потребоваться принять лизензию.
    Если пользователь еще не принял лицензнию, при запросе на авторизацию система вернет ответ с ошибкой
    и полем `license_url`, см. "Получение ключа доступа". В поле `license_url` находится ссылка на документ
    с текстом лицензии. После прочтения документа пользователем, необходимо отправить запрос на подтверждение
    согласия с лицензией, затем повторно провести запрос авторизации.

    Запрос:

    Тип                 URL
    --------------------------------------------------------------------------------------------------------------------------------
    POST                /v1/auth/license
    --------------------------------------------------------------------------------------------------------------------------------

    Параметры в теле запроса (JSON):

    Имя                 Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    login               string                  Логин пользователя
    pass                string                  Пароль
    confirm             integer                 Статус согласия с лицензией

                                                Где:
                                                0 - не согласен
                                                1 - согласен
    --------------------------------------------------------------------------------------------------------------------------------

    Пример запроса:
    {
        "login": "user",
        "pass": "12345",
        "confirm": 1
    }

    Пример успешного ответа:
    {
      "success": 1
    }

    Пример ответа с ошибкой:
    {
      "success": 0,
      "error_code": 201,
      "error_message": "Bad credentials",
      "error_log": {
        "login": "Unknown login"
      }
    }


4 Активности

4.1 Получение списка активностей ( ПН, ПС )

    Запрос:

    Тип                 URL
    --------------------------------------------------------------------------------------------------------------------------------
    GET                 /v1/activities
    --------------------------------------------------------------------------------------------------------------------------------

    Опциональные GET параметры:

    Имя                 Тип                     Описание                                                                Доступность
    --------------------------------------------------------------------------------------------------------------------------------
    date_start          integer|string          Фильр по дате начала активности                                         ПН, ПС
    date_end            integer|string          Фильр по дате завершения активности                                     ПН, ПС
    owner               integer                 Выводить данные о владельце активности.  (0 - нет, 1 - да)              ПН, ПС
    --------------------------------------------------------------------------------------------------------------------------------
    Примечание: * На данный момент для полей `date_start` и `date_end` поддерживается тип данных 'UNIX TIMESTAMP'

    Пример запроса с фильтрацией по дате:

    /v1/activities?date_start=1461763928&date_end=1462763928

    Ответ:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    success              integer                 Статус ответа
    filter               object                  Параметры фильтра применённого к запросу
    items                array                   Массив с результатами запроса
    --------------------------------------------------------------------------------------------------------------------------------

    Описание полей ответа при `success` = 1:


    --[ Для ПН ]--------------------------------------------------------------------------------------------------------------------

    Поле `items`, елемент массива:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    (cм. "4.2 Получение детальной информации об активности", "Описание полей ответа", "Для ПН")
    --------------------------------------------------------------------------------------------------------------------------------


    --[ Для ПC ]--------------------------------------------------------------------------------------------------------------------

    Поле `items`, елемент массива:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    (cм. "4.2 Получение детальной информации об активности", "Описание полей ответа", "Для ПС")
    --------------------------------------------------------------------------------------------------------------------------------


4.2 Получение детальной информации об активности ( ПН, ПС )

    Запрос:

    Тип                 URL
    --------------------------------------------------------------------------------------------------------------------------------
    GET                 /v1/activities/{activity_id}
    --------------------------------------------------------------------------------------------------------------------------------

    Обязательные GET параметры:

    Имя                 Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    activity_id         integer                 ID активности
    --------------------------------------------------------------------------------------------------------------------------------

    Опциональные GET параметры:

    Имя                 Тип                     Описание                                                                Доступность
    --------------------------------------------------------------------------------------------------------------------------------
    owner               integer                 Выводить данные о владельце активности.        (0 - нет, 1 - да)        ПН, ПС
    users               integer                 Выводить данные об активностях пользователей.  (0 - нет, 1 - да)        ПН
    forms               integer                 Выводить данные форм активности.               (0 - нет, 1 - да)        ПН, ПС
    --------------------------------------------------------------------------------------------------------------------------------

    Пример запроса:

    /v1/activities/1?owner=1&users=1&forms=1

    Ответ:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    success              integer                 Статус ответа
    item                 object                  Объект с результатом запроса
    --------------------------------------------------------------------------------------------------------------------------------

    Описание полей ответа при `success` = 1:


    --[ Для ПН ]--------------------------------------------------------------------------------------------------------------------

    Поле `item`:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    id                   integer                 ID активности
    type_id              integer                 ID типа активности
    type_title           string                  Заголовок типа активности
    title                string                  Заголовок активности
    status               integer                 Статус активности            (см. "Статусы активности для ПН")
    date_start           integer                 Запланированная дата начала
    date_end             integer                 Запланированная дата завершения
    started_at           integer                 Фактическая дата старта
    finished_at          integer                 Фактическая дата завершения
    comment              string                  Комментарий
    --------------------------------------------------------------------------------------------------------------------------------

    Дополнительные поля в `item`:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    owner                object                  Данные о владельце активности
    users                array                   Список активностей пользователей, добавленных к активности
    forms                array                   Список форм (отчетов) активности
    --------------------------------------------------------------------------------------------------------------------------------

    Дополнительное поле `owner`:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    id                   integer                 ID владельца
    name                 string                  Имя владельца
    title                string                  Должность владельца
    --------------------------------------------------------------------------------------------------------------------------------

    Дополнительное поле `users`, елемент массива:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    id                   integer                 ID пользователя
    name                 string                  Имя пользователя
    title                string                  Должность пользователя
    status               integer                 Статус активности пользователя   (см. "Статусы активности для ПC")
    reject_type          integer                 Код причины отказа от активности (см. "Коды отказа от активности для ПC")
    started_at           integer                 Фактическая дата старта
    finished_at          integer                 Фактическая дата завершения
    owner_comment        string                  Комментарий владельца активности
    user_comment         string                  Комментарий пользователя
    --------------------------------------------------------------------------------------------------------------------------------

    Дополнительное поле `objects`, елемент массива:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    id                   integer                 ID объекта
    name                 string                  Имя объекта
    address              string                  Адрес объекта
    --------------------------------------------------------------------------------------------------------------------------------

    Дополнительное поле `forms`, елемент массива:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    object_id            integer                 ID объекта формы, для которого создается отчет
    status               integer                 Статус формы               (см. "Статусы формы для ПН")
    object               object                  Данные об объекте          (см. "Дополнительное поле `objects`")
    values               object                  Заполненные значения формы (см. "Значения формы")
    schema               object                  Схема полей формы          (см. "Схема полей формы")
    users                array                   Список статусы подтверждения формы от пользователей
    --------------------------------------------------------------------------------------------------------------------------------

    Дополнительное поле `forms`, елемент массива, поле `users`:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    id                   integer                 ID пользователя
    status               integer                 Статус подтверждения формы  (см. "Статусы формы для ПС")
    --------------------------------------------------------------------------------------------------------------------------------


    --[ Для ПС ]--------------------------------------------------------------------------------------------------------------------

    Поле `item`:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    id                   integer                 ID активности
    type_id              integer                 ID типа активности
    type_title           string                  Заголовок типа активности
    title                string                  Заголовок активности
    status               integer                 Статус активности                   (см. "Статусы активности для ПC")
    reject_type          integer                 Код причины отказа от активности    (см. "Коды отказа от активности для ПC")
    date_start           integer                 Запланированная дата начала
    date_end             integer                 Запланированная дата завершения
    started_at           integer                 Фактическая дата старта
    finished_at          integer                 Фактическая дата завершения
    owner_comment        string                  Комментарий владельца активности
    user_comment         string                  Комментарий пользователя
    --------------------------------------------------------------------------------------------------------------------------------

    Дополнительные поля:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    owner                object                  Данные о владельце активности
    objects              array                   Список объектов данной активности
    forms                array                   Список форм (отчетов) активности
    --------------------------------------------------------------------------------------------------------------------------------

    Дополнительное поле `owner`:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    (cм. "Дополнительное поле `owner`", "Для ПН")
    --------------------------------------------------------------------------------------------------------------------------------

    Дополнительное поле `objects`:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    (cм. "Дополнительное поле `objects`", "Для ПН")
    --------------------------------------------------------------------------------------------------------------------------------

    Дополнительное поле `forms`, елемент массива:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    object_id            integer                 ID объекта формы, для которого создан отчет
    status               integer                 Статус подтверждения формы  (см. "Статусы формы для ПС")
    object               object                  Данные об объекте           (см. "Дополнительное поле `objects`")
    values               object                  Заполненные значения формы  (см. "Значения формы")
    schema               object                  Схема полей формы           (см. "Схема полей формы")
    --------------------------------------------------------------------------------------------------------------------------------


4.3 Обновление информации об активности ( ПН, ПС )

    Запрос:

    Тип                 URL
    --------------------------------------------------------------------------------------------------------------------------------
    POST                /v1/activities/{activity_id}
    --------------------------------------------------------------------------------------------------------------------------------

    Обязательные GET параметры:

    Имя                 Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    activity_id         integer                 ID активности
    --------------------------------------------------------------------------------------------------------------------------------

    Параметры в теле запроса (JSON):

    Имя                 Тип                     Описание                                                   Доступность
    --------------------------------------------------------------------------------------------------------------------------------
    status              integer                 Статус активности                                          ПН, ПС
    title               string                  Заголовок активности                                       ПН
    comment             string                  Комментарий владельца активности                           ПН
    date_start          integer                 Запланированная дата начала                                ПН
    date_end            integer                 Запланированная дата завершения                            ПН
    reject_type         integer                 Код причины отказа от активности                           ПС
    user_comment        string                  Комментарий пользователя                                   ПС
    --------------------------------------------------------------------------------------------------------------------------------
    Примечание: * Набор доступных полей зависит от роли пользователя (ПН, ПС) и от текущего статуса активности.
                  Обрабатываются только доступные для текущей роли и состояния активности поля, все остальные поля игнорируются.

    Пример запроса:

    {
        "status":     0,
        "title":      "Новый заголовок активности",
        "comment":    "Новый комментарий",
        "date_start": 1465371000,
        "date_end":   1465375000
    }

    Ответ:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    success              integer                 Статус ответа
    --------------------------------------------------------------------------------------------------------------------------------


4.4 Создание активности ( ПН )

    Запрос:

    Тип                 URL
    --------------------------------------------------------------------------------------------------------------------------------
    POST                /v1/activities
    --------------------------------------------------------------------------------------------------------------------------------

    Параметры в теле запроса (JSON):

    Имя                 Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    type_id             integer                 Тип активности
    date_start          integer                 Дата начала активности
    date_end            integer                 Дата завершения активности
	title				string					Название активности
    --------------------------------------------------------------------------------------------------------------------------------
    Примечание: * На данный момент для полей `date_start` и `date_end` поддерживается тип данных 'UNIX TIMESTAMP'

    Параметры ответа:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    success              integer                 Статус ответа
    --------------------------------------------------------------------------------------------------------------------------------

4.6 Получение списка типов активности ( ПН )

    Запрос:

    Тип                 URL
    --------------------------------------------------------------------------------------------------------------------------------
    GET                 /v1/activities/types
    --------------------------------------------------------------------------------------------------------------------------------

    Параметры ответа:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    success              integer                 Статус ответа
    items                array                   Массив с результатами запроса
    --------------------------------------------------------------------------------------------------------------------------------

4.6 Получение списка форм активности ( ПН )

    Запрос:

    Тип                 URL
    --------------------------------------------------------------------------------------------------------------------------------
    GET                 /v1/activities/forms
    --------------------------------------------------------------------------------------------------------------------------------

    Параметры ответа:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    success              integer                 Статус ответа
    items                array                   Массив с результатами запроса
    --------------------------------------------------------------------------------------------------------------------------------

4.6 Получение списка пользователей активности ( ПН )

    Запрос:

    Тип                 URL
    --------------------------------------------------------------------------------------------------------------------------------
    GET                 /v1/activities/{activity_id}/users
    --------------------------------------------------------------------------------------------------------------------------------

    Обязательные GET параметры:

    Имя                 Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    activity_id         integer                 ID активности
    user_id             string                  Фильтрация по пользователям.
                                                ID пользователй разделенные запятой.

                                                Пример:

                                                user_id=1,2,5
    --------------------------------------------------------------------------------------------------------------------------------

    Пример запроса с фильтрацией по пользователям:

    /v1/activities/{activity_id}/users?user_id=3,7,1,15

    Параметры ответа:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    success              integer                 Статус ответа
    filter               object                  Параметры фильтра применённого к запросу
    items                array                   Массив с результатами запроса
    --------------------------------------------------------------------------------------------------------------------------------


5 Задания

5.1 Получение списка заданий ( ПН, ПС )

    По умолчанию в полученном списке заданий отсутствуют данные о вложенных задачах.
    Информацию о вложенных задачах можно получить передав в URL параметр tasks=1

    Запрос:

    Тип                 URL
    --------------------------------------------------------------------------------------------------------------------------------
    GET                 /v1/jobs
    --------------------------------------------------------------------------------------------------------------------------------

    Опциональные GET параметры:

    Имя                 Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    tasks               integer                 Флаг передачи списка задач для каждого задания

                                                Где:

                                                0 - не передавать (по умолчанию)
                                                1 - передавать
    --------------------------------------------------------------------------------------------------------------------------------

    Пример запроса с получением информации о задачах:

    /v1/jobs?tasks=1

    Параметры ответа:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    success              integer                 Статус ответа
    filter               object                  Параметры фильтра применённого к запросу
    items                array                   Массив с результатами запроса
    --------------------------------------------------------------------------------------------------------------------------------

    Описание полей ответа при `success` = 1:

    Для ПН:

    Поле `items`, элемент массива:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    id                   integer                 ID задания
    title                string                  Заголовок
    status               integer                 Статус
    is_photo             integer                 Флаг необоходимости прикладывать фото для подтверждения задач
    is_common            integer                 Флаг признак общего задания
    date_start           integer                 Дата начала
    date_end             integer                 Дата завершения
    comment              string                  Комментарий
    owner                object                  Данные о владельце
    tasks                array                   Список задач
    --------------------------------------------------------------------------------------------------------------------------------

    Поле `items.owner`:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    id                   integer                 ID владельца
    name                 string                  Имя
    title                string                  Должность
    --------------------------------------------------------------------------------------------------------------------------------

    Поле `items.tasks`:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    id                   integer                 ID задачи
    title                string                  Заголовок
    photos               array                   Список фото для задачи от владельца задания
    --------------------------------------------------------------------------------------------------------------------------------

    Для ПC:

    Поле `items`, элемент массива:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    id                   integer                 ID задания
    title                string                  Заголовок
    status               integer                 Статус
    is_photo             integer                 Флаг необоходимости прикладывать фото к задачам
    is_common            integer                 Флаг признак общего задания
    date_start           integer                 Дата начала
    date_end             integer                 Дата завершения
    finished_at          integer                 Дата завершения задания пользователем
    owner_comment        string                  Комментарий владельца
    user_comment         string                  Комментарий пользователя
    owner                object                  Данные о владельце
    tasks                array                   Список задач
    --------------------------------------------------------------------------------------------------------------------------------

    Поле `items.owner`:

    --------------------------------------------------------------------------------------------------------------------------------
    См. "Описание поля`items.owner` для ПН"
    --------------------------------------------------------------------------------------------------------------------------------

    Описание поля `items.tasks` для ПН:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    id                   integer                 ID задачи
    title                string                  Заголовок
    status               integer                 Статус
    finished_at          integer                 Дата завершения задачи пользователем
    owner_photos         array                   Список фото для задачи от владельца задания
    user_photos          array                   Список фото для задачи от пользователя
    --------------------------------------------------------------------------------------------------------------------------------

5.2 Получение данных задания ( ПН, ПС )

    Запрос:

    Тип                 URL
    --------------------------------------------------------------------------------------------------------------------------------
    GET                 /v1/jobs/{job_id}
    --------------------------------------------------------------------------------------------------------------------------------

    Обязательные GET параметры:

    Имя                 Тип                      Описание
    --------------------------------------------------------------------------------------------------------------------------------
    job_id              integer                  ID задания
    --------------------------------------------------------------------------------------------------------------------------------

    Параметры ответа:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    success              integer                 Статус ответа
    item                 object                  Объект с результатом запроса
    --------------------------------------------------------------------------------------------------------------------------------

    Описание полей ответа при `success` = 1:

    Для ПН:

    --------------------------------------------------------------------------------------------------------------------------------
    См. "5.1 Получение списка заданий" - "Описание полей ответа для ПН"
    --------------------------------------------------------------------------------------------------------------------------------

    Для ПС:

    --------------------------------------------------------------------------------------------------------------------------------
    См. "5.1 Получение списка заданий" - "Описание полей ответа для ПC"
    --------------------------------------------------------------------------------------------------------------------------------

5.3 Добавление задания ( ПН )

    Запрос:

    Тип                 URL
    --------------------------------------------------------------------------------------------------------------------------------
    POST                /v1/jobs
    --------------------------------------------------------------------------------------------------------------------------------

    Пример тела запроса:

    {
        "title":      "Заголовок задания",
        "comment":    "Комментарий задания"
        "date_start": 1464842830,
        "date_end":   1464868830,
        "is_photo":   1,
        "is_common":  0
    }


    Ответ:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    success              integer                 Статус ответа
    item                 object                  Объект с результатом запроса
    --------------------------------------------------------------------------------------------------------------------------------

    Описание полей ответа при `success` = 1:

    Поле `item`:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    id                   integer                 ID задания
    --------------------------------------------------------------------------------------------------------------------------------

5.4 Обновление данных задания ( ПН )

    Запрос:

    Тип                 URL
    --------------------------------------------------------------------------------------------------------------------------------
    POST                /v1/jobs/{job_id}
    --------------------------------------------------------------------------------------------------------------------------------

    Пример тела запроса:

    {
        "status": 1
    }


    Ответ:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    success              integer                 Статус ответа
    --------------------------------------------------------------------------------------------------------------------------------

5.5 !!! Получить список исполнителей задания ( ПН )


5.6 !!! Добавить пользователей в список исполнителей задания ( ПН )

5.5 Получение списка задач задания ( ПН, ПС )

    Запрос:

    Тип                 URL
    --------------------------------------------------------------------------------------------------------------------------------
    GET                 /v1/jobs/{job_id}/tasks
    --------------------------------------------------------------------------------------------------------------------------------

    Пример запроса с получением информации о задачах:

    v1/jobs/1/tasks

    Ответ:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    success              integer                 Статус ответа
    filter               object                  Параметры фильтра применённого к запросу
    items                array                   Массив с результатами запроса
    --------------------------------------------------------------------------------------------------------------------------------

    Описание полей ответа при `success` = 1:

    Для ПН:

    --------------------------------------------------------------------------------------------------------------------------------
    См. "5.1 Получение списка заданий" - "Описание поля `items.tasks` для ПН"
    --------------------------------------------------------------------------------------------------------------------------------

     Для ПС:

    --------------------------------------------------------------------------------------------------------------------------------
    См. "5.1 Получение списка заданий" - "Описание поля `items.tasks` для ПC"
    --------------------------------------------------------------------------------------------------------------------------------


6 Задачи

6.1 Получение списка задач

    Запрос:

    Тип                 URL
    --------------------------------------------------------------------------------------------------------------------------------
    GET                 /v1/tasks
    --------------------------------------------------------------------------------------------------------------------------------

    Опциональные GET параметры:

    Имя                 Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    job_id              integer                 Возвращать задачи принадлежащие заданию с указанным ID
    --------------------------------------------------------------------------------------------------------------------------------

    Параметры ответа:

     Имя                  Тип                    Описание
    --------------------------------------------------------------------------------------------------------------------------------
    success              integer                 Статус ответа
    filter               object                  Параметры фильтра применённого к запросу
    items                array                   Массив с результатами запроса
    --------------------------------------------------------------------------------------------------------------------------------

6.2 Получение информации о задаче

    Запрос:

    Тип                 URL
    --------------------------------------------------------------------------------------------------------------------------------
    GET                 /v1/tasks/{task_id}
    --------------------------------------------------------------------------------------------------------------------------------

    Параметры ответа:

     Имя                  Тип                    Описание
    --------------------------------------------------------------------------------------------------------------------------------
    success              integer                 Статус ответа
    item                 object                  Объект с результатом запроса
    --------------------------------------------------------------------------------------------------------------------------------

6.3 Обвновление информации о задаче

    Запрос:

    Тип                 URL
    --------------------------------------------------------------------------------------------------------------------------------
    POST                /v1/tasks/{task_id}
    --------------------------------------------------------------------------------------------------------------------------------

    Параметры в теле запроса (JSON):

    Имя                 Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    status              integer                 Статус задания
    --------------------------------------------------------------------------------------------------------------------------------
    Примечание: * В параметрах передаются все необходимые поля для обновления ресурса данного типа.
                  На данный момент перечень полей и их значений находится в разработке.
                  Текущий вариант можно увидеть в запросе на получение детальной информации об задачи.

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    success              integer                 Статус ответа
    --------------------------------------------------------------------------------------------------------------------------------

6.4 Добавление фотографий к задаче

    Запрос:

    Тип                 URL
    --------------------------------------------------------------------------------------------------------------------------------
    POST                /v1/tasks/{task_id}/photos
    --------------------------------------------------------------------------------------------------------------------------------

    Обязательные GET параметры:

    Имя                 Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    task_id             integer                 ID задачи
    --------------------------------------------------------------------------------------------------------------------------------

    Параметры в теле запроса (JSON):

    Имя                 Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    items               array                   Массив с данными загружаемых фотографий
                                                Каждый елемент массива является строкой,
                                                которая содержит данные изображения закодированные
                                                в формате BASE64

                                                Пример:

                                                "items": [
                                                    "1O7y7uPw4PTo/yDk6/8g5+Dk4PfoIDE=",
                                                    "1O7y7uPw4PTo/yDk6/8g5+Dk4PfoIDI="
                                                ]
    --------------------------------------------------------------------------------------------------------------------------------

    Параметры ответа:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    success              integer                 Статус ответа
    items                array                   Массив со ссылками на загруженные фотографии.
                                                 Каждый елемент массива является строкой, которая содержит
                                                 ссылку на загруженное изображение.
                                                 Для изображений, загруженных с ошибкой значение будет null.
                                                 Порядок елементов аналогичен переданному массиву.

                                                 Пример:

                                                 "items": [
                                                    "/uploads/uploaded-photo-1.jpg",
                                                    "/uploads/uploaded-photo-2.jpg",
                                                    null,
                                                    "/uploads/uploaded-photo-4.jpg"
                                                 ]
    --------------------------------------------------------------------------------------------------------------------------------


7 Пользователи

7.1 Получение списка пользователей ( ПН, ПС )

    Данный запрос возвращает список всех пользователей или пользователей принадлежащих вашей команде.

    Запрос:

    Тип                   URL
    --------------------------------------------------------------------------------------------------------------------------------
    GET                   /v1/users
    --------------------------------------------------------------------------------------------------------------------------------

    Параметры ответа:

    Имя                   Тип                      Описание
    --------------------------------------------------------------------------------------------------------------------------------
    success               integer                  Статус ответа
    items                 array                    Массив с результатами запроса
    --------------------------------------------------------------------------------------------------------------------------------


8 Команда

8.1 Получение данных о команде ( ПН, ПС )

    Запрос:

    Тип                   URL
    --------------------------------------------------------------------------------------------------------------------------------
    GET                   /v1/team
    --------------------------------------------------------------------------------------------------------------------------------

    Параметры ответа:

    Имя                   Тип                      Описание
    --------------------------------------------------------------------------------------------------------------------------------
    success               integer                  Статус ответа
    item                  object                   Объект с результатом запроса
    --------------------------------------------------------------------------------------------------------------------------------


9 Стандарты

9.1 Получение структуры стандартов ( ПН, ПС )

    Запрос:

    Тип                   URL
    --------------------------------------------------------------------------------------------------------------------------------
    GET                   /v1/standards
    --------------------------------------------------------------------------------------------------------------------------------

    Параметры ответа:

    Имя                   Тип                      Описание
    --------------------------------------------------------------------------------------------------------------------------------
    success               integer                  Статус ответа
    filter                object                   Параметры фильтра применённого к запросу
    items                 array                    Массив с данными о структуре справочника
    --------------------------------------------------------------------------------------------------------------------------------

9.2 Получение дынных о разделе или документе стандарта ( ПН, ПС )

    Запрос:

    Тип                   URL
    --------------------------------------------------------------------------------------------------------------------------------
    GET                   /v1/standards/{resource_id}
    --------------------------------------------------------------------------------------------------------------------------------

    Обязательные GET параметры:

    Имя                  Тип                      Описание
    --------------------------------------------------------------------------------------------------------------------------------
    resource_id          integer                  ID ресурса в справочнике
    --------------------------------------------------------------------------------------------------------------------------------

    Параметры ответа:

    Имя                   Тип                      Описание
    --------------------------------------------------------------------------------------------------------------------------------
    success               integer                  Статус ответа
    item                  object                   Объект с данными ресурса
    --------------------------------------------------------------------------------------------------------------------------------


10. Местоположение

10.1 Обновить информацию о местоположении пользователя ( ПН, ПС )

    Запрос:

    Тип                 URL
    --------------------------------------------------------------------------------------------------------------------------------
    POST                /v1/location
    --------------------------------------------------------------------------------------------------------------------------------

    Параметры в теле запроса (JSON):

    Имя                 Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    lat                 string                  Широты
    long                string                  Долгота
    --------------------------------------------------------------------------------------------------------------------------------
    Примечание: ВАЖНО! Чтобы исключить потерю точности при округлении, параметры широты и долготы
                передаются и хранятся в виде строк с числовым значением в целочисленном формате или
                в формате с плавающей точкой. Числовые значения соответствуют формату чисел в спецификации JSON.
                Максимальная длина строки для параметров широты и долготы составляет 20 символов.

                Пример:
                {
                    "lat" : "48.324",
                    "long" : "32"
                }

    Параметры ответа:

    Имя                  Тип                    Описание
    --------------------------------------------------------------------------------------------------------------------------------
    success              integer                Статус ответа
    --------------------------------------------------------------------------------------------------------------------------------


11. Формы

11.1 Получение списка форм ( ПН, ПС )

    Данный запрос выдает список всех форм доступных пользователю.

    Запрос:

    Тип                   URL
    --------------------------------------------------------------------------------------------------------------------------------
    GET                   /v1/forms
    --------------------------------------------------------------------------------------------------------------------------------

    Опциональные GET параметры:

    Имя                  Тип                      Описание
    --------------------------------------------------------------------------------------------------------------------------------
    activity_id          integer                  ID активности. Фильтрация результатов по активности
    status               integer                  Статус формы. Фильтрация результатов по стаусу формы
    --------------------------------------------------------------------------------------------------------------------------------
    Примечание: * Коды статусов `status` находятся в разработке.

    Параметры ответа:

    Имя                   Тип                      Описание
    --------------------------------------------------------------------------------------------------------------------------------
    success               integer                  Статус ответа
    filter                object                   Параметры фильтра применённого к запросу
    items                 array                    Массив с результатами запроса
    --------------------------------------------------------------------------------------------------------------------------------

11.2 Получение данных формы

    Запрос возвращает подробные данные формы. Форма всегда привязана к активности и к объекту.
    Ключ формы - комбинация ID активности и ID объекта.

    Запрос:

    Тип                   URL
    --------------------------------------------------------------------------------------------------------------------------------
    GET                   /v1/forms/{activity_id}-{object_id}

                          Где:
                          activity_id - ID активности
                          object_id   - ID объекта
    --------------------------------------------------------------------------------------------------------------------------------

    Параметры ответа:

    Имя                   Тип                      Описание
    --------------------------------------------------------------------------------------------------------------------------------
    success               integer                  Статус ответа
    item                  object                   Объект с результатом запроса
    --------------------------------------------------------------------------------------------------------------------------------

    Описание полей ответа при `success` = 1:

    --- Для ПН ---------------------------------------------------------------------------------------------------------------------
    --------------------------------------------------------------------------------------------------------------------------------

    Поле `item`:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    activity_id          integer                 ID активности
    object_id            integer                 ID объекта
    status               integer                 Статус формы
    statuses             array                   Статусы подтверждения формы от ПС
    values               object                  Объект с заполеннными значениями формы
    form                 object                  Объект со схемой формы
    --------------------------------------------------------------------------------------------------------------------------------

    Поле `item.statuses`:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    user_id              integer                 ID пользователя (ПС)
    status               integer                 Статус формы
    statuses             array                   Статус подтверждения формы

                                                 Где:
                                                  0 - Черновик
                                                  1 - Форма не подтверждена
                                                  2 - Форма подтверждена
    --------------------------------------------------------------------------------------------------------------------------------

    Поле `item.values`:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    id                   integer                 ID поля (Берется из описания полей в схеме формы)
    value                string|integer          Значение поля (Формат значения должен соответствовать описанию поля в схеме формы)
    --------------------------------------------------------------------------------------------------------------------------------

    Поле `item.form`:

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    title                string                  Заголовок формы
    comment              string                  Комментарий
    schema               object                  Схема формы
    --------------------------------------------------------------------------------------------------------------------------------

    Поле `item.form.schema`:

    Ключ объекта - идентификатор поля в форме (ID). Значения ID полей имеют смысл только в рамках конктретной формы.
    Тип значения ID поля может быть как числовым, так и строковым. Ориентроваться на конкретный тип не рекомендуется.

    Пример:
    {
        "1": {
          "label": "Оценка",
          "type": "5_points",
          "id": 1
        },
        "2": {
          "label": "Общая оценка",
          "type": "number",
          "id": 2
        }
    }

    Имя                  Тип                     Описание
    --------------------------------------------------------------------------------------------------------------------------------
    label                string                  Заголовок поля
    type                 string                  Тип поля, см. файл api_v1_forms.txt
    id                   integer                 ID поля
    --------------------------------------------------------------------------------------------------------------------------------


    --- Для ПС ---------------------------------------------------------------------------------------------------------------------
    --------------------------------------------------------------------------------------------------------------------------------
    В ПРОЦЕССЕ...
    -------------------------------------------------------------------------------------------------------------------------------

11.3 Обновление данных формы

    Запрос позволяет обновить данные формы.
    В теле запроса передаются поля формы, которые необходимо обновить.
    Несуществующие или недоступные поля игнорируются.

    Запрос:

    Тип                   URL
    --------------------------------------------------------------------------------------------------------------------------------
    POST                  /v1/forms/{activity_id}-{object_id}

                          Где:
                          activity_id - ID активности
                          object_id   - ID объекта
    --------------------------------------------------------------------------------------------------------------------------------

    Параметры в теле запроса (JSON):

    Имя                  Тип                       Описание
    --------------------------------------------------------------------------------------------------------------------------------
    values               array                     Значения полей формы
    --------------------------------------------------------------------------------------------------------------------------------

    Пример заполнения значений формы:
    {
        "values": [
            {"id": 1, "value": 1},
            {"id": 2, "value": 2},
            {"id": 3, "value": "Хорошо"}
        ]
    }

    Где:
    id    - ID поля
    value - значение (Должно соответствовать формату поля, заданному в схеме формы)

    Параметры ответа:

    Имя                   Тип                      Описание
    --------------------------------------------------------------------------------------------------------------------------------
    success               integer                  Статус ответа
    --------------------------------------------------------------------------------------------------------------------------------

    Пример ответа при `success = 0` (ошибка):

    {
        "success": 0,
        "error_code": 602,
        "error_message": "Invalid form fields",
        "error_log": {
            "values": "Form fields contain errors"
        },
        "error_items": {
            "3": {
              "id": 3,
              "value": "Хорошо",
              "error": "Значение должно быть числом."
            }
        }
    }
